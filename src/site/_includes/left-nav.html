<ul id="expandable-nav">
  <li><a href="#" data-toggle="collapse" data-target="#collapse-architecture">Architecture</a>
    <ul class="collapse subnav" id="collapse-architecture">
      <li><a href="/docs/architectural-overview/">Overview</a></li>
      <li><a href="/system-requirements-ecosystem/">Ecosystem System Requirements</a></li>
      <li><a href="/system-requirements-hardware/">Hardware System Requirements</a></li>
      <li><a href="/controller-cluster-ip/">Controller Cluster IP</a></li>
      <li><a href="/docs/configuration-guide/applications/virtual-services/">Service Engine</a></li>
      <li><a href="#" data-toggle="collapse" data-target="#collapse-architecture-pool">Pool</a>
        <ul class="collapse" id="collapse-architecture-pool">
          <li><a href="/docs/configuration-guide/applications/pools/">Overview</a></li>
          <li><a href="/ab-pool-feature/">A/B Testing</a></li>
          <li><a href="/support-for-sni-extension-in-tls-handshakes-to-pool-servers/">SNI Extension in TLS
            Handshakes</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#" data-toggle="collapse" data-target="#collapse-features">Features</a>
    <ul id="collapse-features" class="collapse">
      <li>
        <a href="#" data-toggle="collapse" data-target="#collapse-features-load-balancing">Load Balancing</a>
        <ul id="collapse-features-load-balancing" class="collapse">
          <li><a href="/autoscale-service-engines/">Autoscaling Service Engines</a></li>
          <li><a href="/docs/configuration-guide/applications/vs-scaling/">Virtual Service Scaling</a></li>
          <li><a href="/bgp-support-for-virtual-services/">BGP Support for Scaling Virtual Services</a></li>
          <li><a href="/docs/configuration-guide/applications/pools/#load_balancing_algorithms">Load Balancing
            Algorithms</a></li>
        </ul>
      </li>
      <li title="Persistence" cookiename="nav-features-lb-persistence">
        <a href="#" data-toggle="collapse" data-target="#collapse-features-persistence">Persistence</a>
        <ul id="collapse-features-persistence" class="collapse ">
          <li><a href="/overview-of-server-persistence/">Overview</a></li>
          <li><a href="/http-cookie-persistence/">HTTP Cookie</a></li>
          <li><a href="/app-cookie-persistence/">App Cookie</a></li>
          <li><a href="/custom-http-header-persistence/">Custom HTTP Header</a></li>
          <li><a href="/client-ip-persistence/">Client IP</a></li>
          <li><a href="/tls-persistence/">TLS</a></li>
          <li><a href="/custom-persistence-with-datascript/">Custom DataScript</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<script type="text/javascript">
  $(document).ready(function () {

    var expanded = Cookies.getJSON('expandable-nav');
    console.log("Expandable nav cookie: " + expanded);
    if (Array.isArray(expanded)) {
      $("#expandable-nav .collapse").removeClass('in');
      for (var i=0; i<expanded.length; i++) {
        $(expanded[i]).collapse("show");
      }
    }
  });

  //when a group is shown, save it in the set of expanded groups
  $("[data-toggle='collapse']").on("click", function () {
    var dataTarget = this.attributes['data-target'].value;
    var tmp = Cookies.getJSON('expandable-nav');
    var expanded;
    if (!Array.isArray(tmp)) {
      expanded = [];
    } else {
      expanded = tmp;
    }
    console.log("data target: " + dataTarget);
    console.log("Expanded before: " + expanded);
    var index = expanded.indexOf(dataTarget);
    if (index >= 0) {
      // remove it
      expanded.splice(index, 1);
    } else {
      // add it
      expanded.push(dataTarget);
    }
    console.log("Expanded after: " + expanded);
    Cookies.set('expandable-nav', expanded);
  });
</script>
