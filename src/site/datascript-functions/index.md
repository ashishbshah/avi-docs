---
title: DataScript: Functions
layout: default
---
DataScripts are comprised of any number of function or method calls which can be used to inspect and act on traffic flowing through a virtual service. DataScript's functions are exposed via Lua libraries and grouped into modules: *string, vs, http, pool, ssl and crypto*. Other Lua libraries may also be used, following the documentation from <a href="http://www.lua.org">www.lua.org</a>. The following functions are available:
**String** **<a href="/datascript-string-beginswith/">string.beginswith( source, target )</a>** Search for string in beginning of a string **<a href="/datascript-string-endswith/">string.endswith( source, target )</a>** Search for string at the end of a string **<a href="/datascript-string-contains/">string.contains( source, target )</a>** Search contains a string in another string **<a href="/datascript-string-upper/">string.upper( source )</a>** Change a string to upper case **<a href="/datascript-string-lower/">string.lower( source )</a>** Change a string to lower case **<a href="/datascript-string-len/">string.len( source )</a>** Returns number of characters in string **<a href="/datascript-string-sub/">string.sub( source, begin, [end] )</a>** Extract a sub-string from a string **VS** **<a href="/datascript-avi-vs-ip/">avi.vs.ip( )</a>** Returns IP address of the VS **<a href="/datascript-avi-vs-port/">avi.vs.port( )</a>** Returns the VS port of the connection **<a href="/datascript-avi-vs-name/">avi.vs.name( )</a>** Returns the name of the VS **<a href="/datascript-avi-vs-client_ip/">avi.vs.client_ip( )</a>** Returns the client IP address **<a href="/datascript-avi-vs-client_port/">avi.vs.client_port( )</a>** Returns the client source port **<a href="/datascript-avi-vs-log/">avi.vs.log( )</a>** Write a custom log to VS > client logs **<a href="/datascript-avi-vs-table_insert/">avi.vs.table_insert( [table_name,] key, value [, lifetime] )</a>** Store custom data in a time based table **<a href="/datascript-avi-vs-table_lookup/">avi.vs.table_lookup( [table_name,] key [, lifetime_exten] )</a>** Lookup data in a table **<a href="/datascript-avi-vs-table_remove/">avi.vs.table_remove( [table_name,] key )</a>** Remove data from a table **<a href="/datascript-avi-vs-table_refresh/">avi.vs.table_refresh( [table_name,] key [, lifetime_exten] )</a>** Update the expire time for a table entry **<a href="/datascript-avi-vs-reqvar/">avi.vs.reqvar.*</a>** Set a global variable usable across events **HTTP** **<a href="/datascript-avi-http-get_uri/">avi.http.get_uri( [false] )</a>** Returns the URI (path plus query) **<a href="/datascript-avi-http-set_uri/">avi.http.set_uri( new_uri )</a>** Change the URI **<a href="/datascript-avi-http-get_path/">avi.http.get_path( [false] )</a>** Returns the URI's path /path.index.htm **<a href="/datascript-avi-http-set_path/">avi.http.set_path( new_uri )</a>** Modify the path of a request **<a href="/datascript-avi-http-get_query/">avi.http.get_query( [arg_name | avi.QUERY_TABLE] [, decode] )</a>** Returns the URI's query ?a=1&b=2 **<a href="/datascript-avi-http-set_query/">avi.http.set_query( integer | string | table )</a>** Modify the query of a request **<a href="/datascript-avi-http-redirect/">avi.http.redirect( uri [,status] )</a>** Redirect a request **<a href="/datascript-avi-http-response/">avi.http.response( status, [headers, [body]] )</a>** Send a defined HTTP response page **<a href="/datascript-avi-http-close_conn/">avi.http.close_conn( [reset] )</a>** Close or reset a TCP connection **<a href="/datascript-avi-http-get_path_tokens/">avi.http.get_path_tokens( [start [, end]] )</a>** Return a subsection of the path **<a href="/datascript-avi-http_host_tokens/">avi.http.get_host_tokens( [start [, end]] )</a>** Return a subsection of the host **<a href="/datascript-avi-http-get_header/">avi.http.get_header( [[name] [context]] )</a>** Return header names or their values **<a href="/datascript-avi-http-add_header/">avi.http.add_header( name, value )</a>** Insert a new header and value **<a href="/datascript-avi-http-replace_header/">avi.http.replace_header( name, value )</a>** Replace an existing headers value **<a href="/datascript-avi-http-remove_header/">avi.http.remove_header( name )</a>** Remove all instances of a header **<a href="/datascript-avi-http-get_cookie/">avi.http.get_cookie( name [, context] )</a>** Return the values of a cookie **<a href="/datascript-avi-http-get_cookie_names/">avi.http.get_cookie_names ( [context] )</a>** Return the names of cookies **<a href="/datascript-avi-http-cookie_exists/">avi.http.cookie_exists( name, [context] )</a>** Validate if a cookie already exists **<a href="/datascript-avi-http-add_cookie/">avi.http.add_cookie( table )</a>** Insert a new cookie **<a href="/datascript-avi-http-remove_cookie/">avi.http.remove_cookie( name1, [name2, ...] )</a>** Remove an existing cookie **<a href="/datascript-avi-http-replace_cookie/">avi.http.replace_cookie( table )</a>** Replace an existing cookies values **<a href="/datascript-avi-http-method/">avi.http.method( )</a>** Return the client's request method **<a href="/datascript-avi-http-hostname/">avi.http.hostname( )</a>** Return the hostname requested by client **<a href="/datascript-avi-http-protocol/">avi.http.protocol( )</a>** Returns the session protocol, http or https **<a href="/datascript-avi-http-scheme/">avi.http.scheme( )</a>** Returns http:// or https:// **<a href="/datascript-avi-http-secure/">avi.http.secure( )</a>** Returns on for https, nil for http **<a href="/datascript-avi-http-get_userid/">avi.http.get_userid( )</a>** Returns the user ID for the session **<a href="/datascript-avi-http-set_userid/">avi.http.set_userid( )</a>** Sets the user ID for the session **<a href="/datascript-avi-http-status/">avi.http.status( )</a>** Returns status code to be sent to client **Pool** <a href="/datascript-avi-pool-get_servers/"><strong>avi.pool.get_servers( pool )</strong></a> Returns up and total server count <a href="/datascript-avi-pool-get_server_status/"><strong>avi.pool.get_server_status( pool, server, port )</strong></a> Returns the up/down status of the server **<a href="/datascript-avi-pool-select/">avi.pool.select( pool [, server [, port]] )</a>** Pick a specific pool **<a href="/datascript-avi-pool-server_ip/">avi.pool.server_ip( )</a>** Pick a specific pool server **SSL** **<a href="/datascript-avi-ssl-protocol/">avi.ssl.protocol( )</a>** Return the SSL version **<a href="/datascript-avi-ssl-cipher/">avi.ssl.cipher( [true] )</a>** Return the SSL ciphers and settings **<a href="/datascript-avi-ssl-server_name/">avi.ssl.server_name( )</a>** Return SNI name field <a href="/datascript-avi-ssl-client_cert/"><strong>avi.ssl.client_cert( [ [avi.CLIENT_CERT] [, avi.CLIENT_CERT_FINGERPRINT] [, avi.CLIENT_CERT_SUBJECT] [, avi.CLIENT_CERT_ISSUER] [, avi.CLIENT_CERT_SERIAL]] )</strong></a> Returns the client's certificate, or part of it **Crypto** **<a href="/datascript-avi-crypto-encrypt/">avi.crypto.encrypt( plaintext, key [, iv [, algo]] )</a>** Encrypt content **<a href="/datascript-avi-crypto-decrypt/">avi.crypto.decrypt( ciphertext, key [, iv [, algo]] )</a>** Decrypt content